<html>
<head>
<title>Coverage Report</title>
<link title="Style" type="text/css" rel="stylesheet" href="css/main.css" />
<script type="text/javascript" src="js/popup.js"></script>
</head>
<body>
<h5>Coverage Report - org.apache.commons.math.ode.GraggBulirschStoerIntegrator</h5>
<p>
<table class="report">
<thead><tr>  <td class="heading">Classes in this File</td>  <td class="heading" width="20%"><a class="dfn" href="help.html" onClick="popupwindow('help.html'); return false;">Line Coverage</a></td>  <td class="heading" width="20%"><a class="dfn" href="help.html" onClick="popupwindow('help.html'); return false;">Branch Coverage</a></td>  <td class="heading" width="10%"><a class="dfn" href="help.html" onClick="popupwindow('help.html'); return false;">Complexity</a></td></tr></thead>
  <tr><td class="text"><a href="org.apache.commons.math.ode.GraggBulirschStoerIntegrator.html">GraggBulirschStoerIntegrator</a></td><td class="value"><table cellpadding="0" cellspacing="0" align="right"><tr><td>92%&nbsp;</td><td><table class="percentGraph" cellpadding="0" cellspacing="0" width="100"><tr><td class="covered" width="92"></td><td class="uncovered" width="7"></td></tr></table></td></tr></table></td><td class="value"><table cellpadding="0" cellspacing="0" align="right"><tr><td>98%&nbsp;</td><td><table class="percentGraph" cellpadding="0" cellspacing="0" width="100"><tr><td class="covered" width="98"></td><td class="uncovered" width="1"></td></tr></table></td></tr></table></td><td class="value"><span class="hidden">8.0;</span>8</td></tr>
</table>
</p>
<p>
<table cellspacing="0" cellpadding="0" class="src">
<tr>
  <td class="numLine">&nbsp;1</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">/*</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;2</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * Licensed to the Apache Software Foundation (ASF) under one or more</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;3</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * contributor license agreements.  See the NOTICE file distributed with</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;4</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * this work for additional information regarding copyright ownership.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;5</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * The ASF licenses this file to You under the Apache License, Version 2.0</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;6</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * (the "License"); you may not use this file except in compliance with</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;7</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * the License.  You may obtain a copy of the License at</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;8</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;9</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;10</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;11</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;12</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * distributed under the License is distributed on an "AS IS" BASIS,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;13</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;14</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * See the License for the specific language governing permissions and</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;15</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * limitations under the License.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;16</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;17</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;18</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="keyword">package</span> org.apache.commons.math.ode;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;19</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;20</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">/**</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;21</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * This class implements a Gragg-Bulirsch-Stoer integrator for</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;22</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * Ordinary Differential Equations.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;23</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;24</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;p&gt;The Gragg-Bulirsch-Stoer algorithm is one of the most efficient</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;25</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * ones currently available for smooth problems. It uses Richardson</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;26</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * extrapolation to estimate what would be the solution if the step</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;27</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * size could be decreased down to zero.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;28</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;29</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;30</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * This method changes both the step size and the order during</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;31</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * integration, in order to minimize computation cost. It is</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;32</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * particularly well suited when a very high precision is needed. The</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;33</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * limit where this method becomes more efficient than high-order</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;34</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * Runge-Kutta-Fehlberg methods like {@link DormandPrince853Integrator</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;35</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * Dormand-Prince 8(5,3)} depends on the problem. Results given in the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;36</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * Hairer, Norsett and Wanner book show for example that this limit</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;37</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * occurs for accuracy around 1e-6 when integrating Saltzam-Lorenz</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;38</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * equations (the authors note this problem is &lt;i&gt;extremely sensitive</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;39</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * to the errors in the first integration steps&lt;/i&gt;), and around 1e-11</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;40</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * for a two dimensional celestial mechanics problems with seven</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;41</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * bodies (pleiades problem, involving quasi-collisions for which</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;42</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;i&gt;automatic step size control is essential&lt;/i&gt;).</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;43</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;44</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;45</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;46</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * This implementation is basically a reimplementation in Java of the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;47</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;a</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;48</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * href="http://www.unige.ch/math/folks/hairer/prog/nonstiff/odex.f"&gt;odex&lt;/a&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;49</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * fortran code by E. Hairer and G. Wanner. The redistribution policy</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;50</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * for this code is available &lt;a</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;51</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * href="http://www.unige.ch/~hairer/prog/licence.txt"&gt;here&lt;/a&gt;, for</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;52</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * convenience, it is reproduced below.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;53</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;54</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;55</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;table border="0" width="80%" cellpadding="10" align="center" bgcolor="#E0E0E0"&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;56</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;tr&gt;&lt;td&gt;Copyright (c) 2004, Ernst Hairer&lt;/td&gt;&lt;/tr&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;57</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;58</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;tr&gt;&lt;td&gt;Redistribution and use in source and binary forms, with or</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;59</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * without modification, are permitted provided that the following</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;60</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * conditions are met:</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;61</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;ul&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;62</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *  &lt;li&gt;Redistributions of source code must retain the above copyright</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;63</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *      notice, this list of conditions and the following disclaimer.&lt;/li&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;64</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *  &lt;li&gt;Redistributions in binary form must reproduce the above copyright</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;65</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *      notice, this list of conditions and the following disclaimer in the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;66</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> *      documentation and/or other materials provided with the distribution.&lt;/li&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;67</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;/ul&gt;&lt;/td&gt;&lt;/tr&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;68</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;69</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;tr&gt;&lt;td&gt;&lt;strong&gt;THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;70</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;71</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;72</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * FOR A  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;73</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;74</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;75</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;76</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;77</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;78</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;79</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;80</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * &lt;/table&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;81</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;82</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * @author E. Hairer and G. Wanner (fortran version)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;83</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> * @version $Id: GraggBulirschStoerIntegrator.java 1705 2006-09-17 19:57:39Z luc $</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;84</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;85</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment"> */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;86</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;87</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="keyword">public</span> <span class="keyword">class</span> GraggBulirschStoerIntegrator</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;88</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">extends</span> AdaptiveStepsizeIntegrator {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;89</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;90</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String methodName = <span class="string">"Gragg-Bulirsch-Stoer"</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;91</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;92</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Simple constructor.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;93</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * Build a Gragg-Bulirsch-Stoer integrator with the given step</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;94</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * bounds. All tuning parameters are set to their default</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;95</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * values. The default step handler does nothing.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;96</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param minStep minimal step (must be positive even for backward</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;97</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * integration), the last step can be smaller than this</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;98</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param maxStep maximal step (must be positive even for backward</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;99</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * integration)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;100</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param scalAbsoluteTolerance allowed absolute error</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;101</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param scalRelativeTolerance allowed relative error</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;102</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;103</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> GraggBulirschStoerIntegrator(<span class="keyword">double</span> minStep, <span class="keyword">double</span> maxStep,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;104</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      <span class="keyword">double</span> scalAbsoluteTolerance,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;105</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      <span class="keyword">double</span> scalRelativeTolerance) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;106</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">super</span>(minStep, maxStep, scalAbsoluteTolerance, scalRelativeTolerance);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;107</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    denseOutput = (handler.requiresDenseOutput()</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;108</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                   || (! switchesHandler.isEmpty()));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;109</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    setStabilityCheck(<span class="keyword">true</span>, -1, -1, -1);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;110</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    setStepsizeControl(-1, -1, -1, -1);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;111</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    setOrderControl(-1, -1, -1);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;112</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    setInterpolationControl(<span class="keyword">true</span>, -1);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;113</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;114</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;115</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Simple constructor.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;116</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * Build a Gragg-Bulirsch-Stoer integrator with the given step</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;117</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * bounds. All tuning parameters are set to their default</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;118</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * values. The default step handler does nothing.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;119</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param minStep minimal step (must be positive even for backward</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;120</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * integration), the last step can be smaller than this</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;121</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param maxStep maximal step (must be positive even for backward</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;122</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * integration)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;123</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param vecAbsoluteTolerance allowed absolute error</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;124</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param vecRelativeTolerance allowed relative error</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;125</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;126</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> GraggBulirschStoerIntegrator(<span class="keyword">double</span> minStep, <span class="keyword">double</span> maxStep,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;127</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      <span class="keyword">double</span>[] vecAbsoluteTolerance,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;128</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      <span class="keyword">double</span>[] vecRelativeTolerance) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;129</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    <span class="keyword">super</span>(minStep, maxStep, vecAbsoluteTolerance, vecRelativeTolerance);</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;130</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    denseOutput = (handler.requiresDenseOutput()</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;131</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                   || (! switchesHandler.isEmpty()));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;132</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    setStabilityCheck(<span class="keyword">true</span>, -1, -1, -1);</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;133</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    setStepsizeControl(-1, -1, -1, -1);</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;134</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    setOrderControl(-1, -1, -1);</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;135</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    setInterpolationControl(<span class="keyword">true</span>, -1);</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;136</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;  }</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;137</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;138</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Set the stability check controls.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;139</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;The stability check is performed on the first few iterations of</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;140</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * the extrapolation scheme. If this test fails, the step is rejected</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;141</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * and the stepsize is reduced.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;142</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;By default, the test is performed, at most during two</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;143</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * iterations at each step, and at most once for each of these</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;144</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * iterations. The default stepsize reduction factor is 0.5.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;145</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param performTest if true, stability check will be performed,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;146</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">     if false, the check will be skipped</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;147</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param maxIter maximal number of iterations for which checks are</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;148</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * performed (the number of iterations is reset to default if negative</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;149</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * or null)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;150</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param maxChecks maximal number of checks for each iteration</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;151</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * (the number of checks is reset to default if negative or null)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;152</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param stabilityReduction stepsize reduction factor in case of</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;153</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * failure (the factor is reset to default if lower than 0.0001 or</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;154</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * greater than 0.9999)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;155</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;156</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> setStabilityCheck(<span class="keyword">boolean</span> performTest,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;157</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                <span class="keyword">int</span> maxIter, <span class="keyword">int</span> maxChecks,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;158</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                <span class="keyword">double</span> stabilityReduction) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;159</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;160</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">this</span>.performTest = performTest;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;161</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">this</span>.maxIter     = (maxIter   &lt;= 0) ? 2 : maxIter;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;162</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">this</span>.maxChecks   = (maxChecks &lt;= 0) ? 1 : maxChecks;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;163</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;164</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((stabilityReduction &lt; 0.0001) || (stabilityReduction &gt; 0.9999)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;165</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.stabilityReduction = 0.5;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;166</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;167</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.stabilityReduction = stabilityReduction;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;168</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;169</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;170</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;171</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;172</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Set the step size control factors.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;173</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;174</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;The new step size hNew is computed from the old one h by:</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;175</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;pre&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;176</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * hNew = h * stepControl2 / (err/stepControl1)^(1/(2k+1))</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;177</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;/pre&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;178</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * where err is the scaled error and k the iteration number of the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;179</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * extrapolation scheme (counting from 0). The default values are</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;180</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * 0.65 for stepControl1 and 0.94 for stepControl2.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;181</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;The step size is subject to the restriction:</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;182</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;pre&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;183</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * stepControl3^(1/(2k+1))/stepControl4 &lt;= hNew/h &lt;= 1/stepControl3^(1/(2k+1))</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;184</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;/pre&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;185</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * The default values are 0.02 for stepControl3 and 4.0 for</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;186</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * stepControl4.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;187</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param stepControl1 first stepsize control factor (the factor is</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;188</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * reset to default if lower than 0.0001 or greater than 0.9999)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;189</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param stepControl2 second stepsize control factor (the factor</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;190</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * is reset to default if lower than 0.0001 or greater than 0.9999)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;191</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param stepControl3 third stepsize control factor (the factor is</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;192</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * reset to default if lower than 0.0001 or greater than 0.9999)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;193</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param stepControl4 fourth stepsize control factor (the factor</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;194</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * is reset to default if lower than 1.0001 or greater than 999.9)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;195</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;196</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> setStepsizeControl(<span class="keyword">double</span> stepControl1, <span class="keyword">double</span> stepControl2,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;197</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                 <span class="keyword">double</span> stepControl3, <span class="keyword">double</span> stepControl4) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;198</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;199</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((stepControl1 &lt; 0.0001) || (stepControl1 &gt; 0.9999)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;200</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.stepControl1 = 0.65;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;201</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;202</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.stepControl1 = stepControl1;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;203</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;204</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;205</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((stepControl2 &lt; 0.0001) || (stepControl2 &gt; 0.9999)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;206</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.stepControl2 = 0.94;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;207</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;208</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.stepControl2 = stepControl2;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;209</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;210</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;211</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((stepControl3 &lt; 0.0001) || (stepControl3 &gt; 0.9999)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;212</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.stepControl3 = 0.02;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;213</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;214</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.stepControl3 = stepControl3;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;215</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;216</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;217</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((stepControl4 &lt; 1.0001) || (stepControl4 &gt; 999.9)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;218</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.stepControl4 = 4.0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;219</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;220</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.stepControl4 = stepControl4;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;221</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;222</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;223</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;224</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;225</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Set the order control parameters.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;226</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;The Gragg-Bulirsch-Stoer method changes both the step size and</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;227</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * the order during integration, in order to minimize computation</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;228</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * cost. Each extrapolation step increases the order by 2, so the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;229</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * maximal order that will be used is always even, it is twice the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;230</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * maximal number of columns in the extrapolation table.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;231</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;pre&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;232</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * order is decreased if w(k-1) &lt;= w(k)   * orderControl1</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;233</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * order is increased if w(k)   &lt;= w(k-1) * orderControl2</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;234</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;/pre&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;235</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;where w is the table of work per unit step for each order</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;236</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * (number of function calls divided by the step length), and k is</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;237</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * the current order.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;238</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * &lt;p&gt;The default maximal order after construction is 18 (i.e. the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;239</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * maximal number of columns is 9). The default values are 0.8 for</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;240</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * orderControl1 and 0.9 for orderControl2.&lt;/p&gt;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;241</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param maxOrder maximal order in the extrapolation table (the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;242</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * maximal order is reset to default if order &lt;= 6 or odd)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;243</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param orderControl1 first order control factor (the factor is</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;244</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * reset to default if lower than 0.0001 or greater than 0.9999)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;245</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param orderControl2 second order control factor (the factor</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;246</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * is reset to default if lower than 0.0001 or greater than 0.9999)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;247</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;248</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> setOrderControl(<span class="keyword">int</span> maxOrder,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;249</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                              <span class="keyword">double</span> orderControl1, <span class="keyword">double</span> orderControl2) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;250</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;251</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((maxOrder &lt;= 6) || (maxOrder % 2 != 0)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;252</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.maxOrder = 18;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;253</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;254</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;255</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((orderControl1 &lt; 0.0001) || (orderControl1 &gt; 0.9999)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;256</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.orderControl1 = 0.8;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;257</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;258</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.orderControl1 = orderControl1;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;259</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;260</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;261</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((orderControl2 &lt; 0.0001) || (orderControl2 &gt; 0.9999)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;262</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.orderControl2 = 0.9;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;263</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;264</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.orderControl2 = orderControl2;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;265</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;266</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;267</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// reinitialize the arrays</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;268</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    initializeArrays();</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;269</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;270</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;271</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;272</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Set the step handler for this integrator.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;273</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * The handler will be called by the integrator for each accepted</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;274</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * step.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;275</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param handler handler for the accepted steps</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;276</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;277</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> setStepHandler (StepHandler handler) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;278</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;279</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">super</span>.setStepHandler(handler);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;280</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;    denseOutput = (handler.requiresDenseOutput()</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;281</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                   || (! switchesHandler.isEmpty()));</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;282</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;283</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// reinitialize the arrays</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;284</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;    initializeArrays();</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;285</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;286</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;287</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;288</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Add a switching function to the integrator.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;289</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param function switching function</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;290</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param maxCheckInterval maximal time interval between switching</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;291</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * function checks (this interval prevents missing sign changes in</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;292</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * case the integration steps becomes very large)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;293</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param convergence convergence threshold in the event time search</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;294</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;295</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> addSwitchingFunction(SwitchingFunction function,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;296</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                   <span class="keyword">double</span> maxCheckInterval,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;297</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                   <span class="keyword">double</span> convergence) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;298</td>
  <td class="nbHitsCovered">&nbsp;3</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">super</span>.addSwitchingFunction(function, maxCheckInterval, convergence);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;299</td>
  <td class="nbHitsCovered">&nbsp;3</td>
  <td class="src"><pre class="src">&nbsp;    denseOutput = (handler.requiresDenseOutput()</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;300</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                   || (! switchesHandler.isEmpty()));</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;301</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;302</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// reinitialize the arrays</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;303</td>
  <td class="nbHitsCovered">&nbsp;3</td>
  <td class="src"><pre class="src">&nbsp;    initializeArrays();</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;304</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;305</td>
  <td class="nbHitsCovered">&nbsp;3</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;306</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;307</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Initialize the integrator internal arrays. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;308</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">void</span> initializeArrays() {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;309</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;310</td>
  <td class="nbHitsCovered">&nbsp;32</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">int</span> size = maxOrder / 2;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;311</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;312</td>
  <td class="nbHitsCovered">&nbsp;32</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((sequence == <span class="keyword">null</span>) || (sequence.length != size)) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;313</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// all arrays should be reallocated with the right size</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;314</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      sequence        = <span class="keyword">new</span> <span class="keyword">int</span>[size];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;315</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      costPerStep     = <span class="keyword">new</span> <span class="keyword">int</span>[size];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;316</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      coeff           = <span class="keyword">new</span> <span class="keyword">double</span>[size][];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;317</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      costPerTimeUnit = <span class="keyword">new</span> <span class="keyword">double</span>[size];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;318</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      optimalStep     = <span class="keyword">new</span> <span class="keyword">double</span>[size];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;319</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;320</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;321</td>
  <td class="nbHitsCovered">&nbsp;32</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (denseOutput) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;322</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// step size sequence: 2, 6, 10, 14, ...</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;323</td>
  <td class="nbHitsCovered">&nbsp;150</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> k = 0; k &lt; size; ++k) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;324</td>
  <td class="nbHitsCovered">&nbsp;135</td>
  <td class="src"><pre class="src">&nbsp;        sequence[k] = 4 * k + 2;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;325</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;326</td>
  <td class="nbHitsCovered">&nbsp;15</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;327</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// step size sequence: 2, 4, 6, 8, ...</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;328</td>
  <td class="nbHitsCovered">&nbsp;170</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> k = 0; k &lt; size; ++k) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;329</td>
  <td class="nbHitsCovered">&nbsp;153</td>
  <td class="src"><pre class="src">&nbsp;        sequence[k] = 2 * (k + 1); </pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;330</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;331</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;332</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;333</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// initialize the order selection cost array</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;334</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// (number of function calls for each column of the extrapolation table)</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;335</td>
  <td class="nbHitsCovered">&nbsp;32</td>
  <td class="src"><pre class="src">&nbsp;    costPerStep[0] = sequence[0] + 1;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;336</td>
  <td class="nbHitsCovered">&nbsp;288</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> k = 1; k &lt; size; ++k) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;337</td>
  <td class="nbHitsCovered">&nbsp;256</td>
  <td class="src"><pre class="src">&nbsp;      costPerStep[k] = costPerStep[k-1] + sequence[k];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;338</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;339</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;340</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// initialize the extrapolation tables</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;341</td>
  <td class="nbHitsCovered">&nbsp;320</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> k = 0; k &lt; size; ++k) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;342</td>
  <td class="nbHitsCovered">&nbsp;288</td>
  <td class="src"><pre class="src">&nbsp;      coeff[k] = (k &gt; 0) ? <span class="keyword">new</span> <span class="keyword">double</span>[k] : <span class="keyword">null</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;343</td>
  <td class="nbHitsCovered">&nbsp;1440</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> l = 0; l &lt; k; ++l) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;344</td>
  <td class="nbHitsCovered">&nbsp;1152</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">double</span> ratio = ((<span class="keyword">double</span>) sequence[k]) / sequence[k-l-1];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;345</td>
  <td class="nbHitsCovered">&nbsp;1152</td>
  <td class="src"><pre class="src">&nbsp;        coeff[k][l] = 1.0 / (ratio * ratio - 1.0);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;346</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;347</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;348</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;349</td>
  <td class="nbHitsCovered">&nbsp;32</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;350</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;351</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Set the interpolation order control parameter.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;352</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * The interpolation order for dense output is 2k - mudif + 1. The</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;353</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * default value for mudif is 4 and the interpolation error is used</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;354</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * in stepsize control by default.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;355</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;356</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param useInterpolationError if true, interpolation error is used</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;357</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * for stepsize control</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;358</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param mudif interpolation order control parameter (the parameter</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;359</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * is reset to default if &lt;= 0 or &gt;= 7)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;360</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;361</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> setInterpolationControl(<span class="keyword">boolean</span> useInterpolationError,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;362</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      <span class="keyword">int</span> mudif) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;363</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;364</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">this</span>.useInterpolationError = useInterpolationError;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;365</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;366</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> ((mudif &lt;= 0) || (mudif &gt;= 7)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;367</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">this</span>.mudif = 4;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;368</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;369</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">this</span>.mudif = mudif;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;370</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;371</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;372</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;373</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;374</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Get the name of the method.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;375</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @return name of the method</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;376</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;377</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> String getName() {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;378</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;    <span class="keyword">return</span> methodName;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;379</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;380</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;381</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Update scaling array.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;382</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param y1 first state vector to use for scaling</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;383</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param y2 second state vector to use for scaling</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;384</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param scale scaling array to update</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;385</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;386</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">void</span> rescale(<span class="keyword">double</span>[] y1, <span class="keyword">double</span>[] y2, <span class="keyword">double</span>[] scale) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;387</td>
  <td class="nbHitsCovered">&nbsp;1044</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (vecAbsoluteTolerance == <span class="keyword">null</span>) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;388</td>
  <td class="nbHitsCovered">&nbsp;4682</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; scale.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;389</td>
  <td class="nbHitsCovered">&nbsp;3638</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">double</span> yi = Math.max(Math.abs(y1[i]), Math.abs(y2[i]));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;390</td>
  <td class="nbHitsCovered">&nbsp;3638</td>
  <td class="src"><pre class="src">&nbsp;        scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * yi;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;391</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;392</td>
  <td class="nbHitsCovered">&nbsp;1044</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;393</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; scale.length; ++i) {</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;394</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;        <span class="keyword">double</span> yi = Math.max(Math.abs(y1[i]), Math.abs(y2[i]));</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;395</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;        scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * yi;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;396</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;397</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;398</td>
  <td class="nbHitsCovered">&nbsp;1044</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;399</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;400</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Perform integration over one step using substeps of a modified</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;401</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * midpoint method.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;402</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param equations differential equations to integrate</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;403</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param t0 initial time</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;404</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param y0 initial value of the state vector at t0</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;405</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param step global step</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;406</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param k iteration number (from 0 to sequence.length - 1)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;407</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param scale scaling array</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;408</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param f placeholder where to put the state vector derivatives at each substep</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;409</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   *          (element 0 already contains initial derivative)</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;410</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param yMiddle placeholder where to put the state vector at the middle of the step</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;411</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param yEnd placeholder where to put the state vector at the end</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;412</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param yTmp placeholder for one state vector</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;413</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @return true if computation was done properly,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;414</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   *         false if stability check failed before end of computation</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;415</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @throws DerivativeException this exception is propagated to the caller if the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;416</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * underlying user function triggers one</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;417</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;418</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">boolean</span> tryStep(FirstOrderDifferentialEquations equations,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;419</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                          <span class="keyword">double</span> t0, <span class="keyword">double</span>[] y0, <span class="keyword">double</span> step, <span class="keyword">int</span> k,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;420</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                          <span class="keyword">double</span>[] scale, <span class="keyword">double</span>[][] f,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;421</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                          <span class="keyword">double</span>[] yMiddle, <span class="keyword">double</span>[] yEnd,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;422</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                          <span class="keyword">double</span>[] yTmp)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;423</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">throws</span> DerivativeException {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;424</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;425</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">int</span>    n        = sequence[k];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;426</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span> subStep  = step / n;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;427</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span> subStep2 = 2 * subStep;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;428</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;429</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// first substep</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;430</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span> t = t0 + subStep;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;431</td>
  <td class="nbHitsCovered">&nbsp;6247</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;432</td>
  <td class="nbHitsCovered">&nbsp;4865</td>
  <td class="src"><pre class="src">&nbsp;      yTmp[i] = y0[i];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;433</td>
  <td class="nbHitsCovered">&nbsp;4865</td>
  <td class="src"><pre class="src">&nbsp;      yEnd[i] = y0[i] + subStep * f[0][i];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;434</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;435</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;    equations.computeDerivatives(t, yEnd, f[1]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;436</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;437</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// other substeps</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;438</td>
  <td class="nbHitsCovered">&nbsp;11069</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> j = 1; j &lt; n; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;439</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;440</td>
  <td class="nbHitsCovered">&nbsp;9742</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (2 * j == n) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;441</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// save the point at the middle of the step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;442</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;        System.arraycopy(yEnd, 0, yMiddle, 0, y0.length);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;443</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;444</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;445</td>
  <td class="nbHitsCovered">&nbsp;9742</td>
  <td class="src"><pre class="src">&nbsp;      t += subStep;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;446</td>
  <td class="nbHitsCovered">&nbsp;42535</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;447</td>
  <td class="nbHitsCovered">&nbsp;32793</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">double</span> middle = yEnd[i];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;448</td>
  <td class="nbHitsCovered">&nbsp;32793</td>
  <td class="src"><pre class="src">&nbsp;        yEnd[i]       = yTmp[i] + subStep2 * f[j][i];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;449</td>
  <td class="nbHitsCovered">&nbsp;32793</td>
  <td class="src"><pre class="src">&nbsp;        yTmp[i]       = middle;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;450</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;451</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;452</td>
  <td class="nbHitsCovered">&nbsp;9742</td>
  <td class="src"><pre class="src">&nbsp;      equations.computeDerivatives(t, yEnd, f[j+1]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;453</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;454</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// stability check</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;455</td>
  <td class="nbHitsCovered">&nbsp;9742</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (performTest &amp;&amp; (j &lt;= maxChecks) &amp;&amp; (k &lt; maxIter)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;456</td>
  <td class="nbHitsCovered">&nbsp;649</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">double</span> initialNorm = 0.0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;457</td>
  <td class="nbHitsCovered">&nbsp;2957</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">for</span> (<span class="keyword">int</span> l = 0; l &lt; y0.length; ++l) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;458</td>
  <td class="nbHitsCovered">&nbsp;2308</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">double</span> ratio = f[0][l] / scale[l];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;459</td>
  <td class="nbHitsCovered">&nbsp;2308</td>
  <td class="src"><pre class="src">&nbsp;          initialNorm += ratio * ratio;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;460</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;461</td>
  <td class="nbHitsCovered">&nbsp;649</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">double</span> deltaNorm = 0.0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;462</td>
  <td class="nbHitsCovered">&nbsp;2957</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">for</span> (<span class="keyword">int</span> l = 0; l &lt; y0.length; ++l) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;463</td>
  <td class="nbHitsCovered">&nbsp;2308</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">double</span> ratio = (f[j+1][l] - f[0][l]) / scale[l];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;464</td>
  <td class="nbHitsCovered">&nbsp;2308</td>
  <td class="src"><pre class="src">&nbsp;          deltaNorm += ratio * ratio;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;465</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;466</td>
  <td class="nbHitsCovered">&nbsp;649</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (deltaNorm &gt; 4 * Math.max(1.0e-15, initialNorm)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;467</td>
  <td class="nbHitsCovered">&nbsp;55</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">return</span> <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;468</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;469</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;470</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;471</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;472</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;473</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// correction of the last substep (at t0 + step)</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;474</td>
  <td class="nbHitsCovered">&nbsp;5980</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;475</td>
  <td class="nbHitsCovered">&nbsp;4653</td>
  <td class="src"><pre class="src">&nbsp;      yEnd[i] = 0.5 * (yTmp[i] + yEnd[i] + subStep * f[n][i]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;476</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;477</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;478</td>
  <td class="nbHitsCovered">&nbsp;1327</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">return</span> <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;479</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;480</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;481</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;482</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** Extrapolate a vector.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;483</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param offset offset to use in the coefficients table</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;484</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param k index of the last updated point</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;485</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param diag working diagonal of the Aitken-Neville's</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;486</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * triangle, without the last element</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;487</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   * @param last last element</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;488</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;489</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">void</span> extrapolate(<span class="keyword">int</span> offset, <span class="keyword">int</span> k, <span class="keyword">double</span>[][] diag, <span class="keyword">double</span>[] last) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;490</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;491</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// update the diagonal</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;492</td>
  <td class="nbHitsCovered">&nbsp;10568</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> j = 1; j &lt; k; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;493</td>
  <td class="nbHitsCovered">&nbsp;23251</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; last.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;494</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// Aitken-Neville's recursive formula</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;495</td>
  <td class="nbHitsCovered">&nbsp;17580</td>
  <td class="src"><pre class="src">&nbsp;        diag[k-j-1][i] = diag[k-j][i]</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;496</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                       + coeff[k+offset][j-1] * (diag[k-j][i] - diag[k-j-1][i]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;497</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;498</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;499</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;500</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// update the last element</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;501</td>
  <td class="nbHitsCovered">&nbsp;20843</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; last.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;502</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// Aitken-Neville's recursive formula</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;503</td>
  <td class="nbHitsCovered">&nbsp;15946</td>
  <td class="src"><pre class="src">&nbsp;      last[i] = diag[0][i] + coeff[k+offset][k-1] * (diag[0][i] - last[i]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;504</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;505</td>
  <td class="nbHitsCovered">&nbsp;4897</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;506</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;507</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">public</span> <span class="keyword">void</span> integrate(FirstOrderDifferentialEquations equations,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;508</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                        <span class="keyword">double</span> t0, <span class="keyword">double</span>[] y0, <span class="keyword">double</span> t, <span class="keyword">double</span>[] y)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;509</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">throws</span> DerivativeException, IntegratorException {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;510</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;511</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// sanity check</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;512</td>
  <td class="nbHitsCovered">&nbsp;16</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (equations.getDimension() != y0.length) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;513</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">throw</span> <span class="keyword">new</span> IntegratorException(<span class="string">"dimensions mismatch: "</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;514</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                    + <span class="string">"ODE problem has dimension {0}"</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;515</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                    + <span class="string">", state vector has dimension {1}"</span>,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;516</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                    <span class="keyword">new</span> String[] {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;517</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      Integer.toString(equations.getDimension()),</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;518</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      Integer.toString(y0.length)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;519</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                    });</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;520</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;521</td>
  <td class="nbHitsCovered">&nbsp;15</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (Math.abs(t - t0) &lt;= 1.0e-12 * Math.max(Math.abs(t0), Math.abs(t))) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;522</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">throw</span> <span class="keyword">new</span> IntegratorException(<span class="string">"too small integration interval: length = {0}"</span>,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;523</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                    <span class="keyword">new</span> String[] {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;524</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      Double.toString(Math.abs(t - t0))</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;525</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                    });</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;526</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;527</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;528</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">boolean</span> forward = (t &gt; t0);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;529</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;530</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// create some internal working arrays</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;531</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[] yDot0   = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;532</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[] y1      = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;533</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[] yTmp    = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;534</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[] yTmpDot = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;535</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;536</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[][] diagonal = <span class="keyword">new</span> <span class="keyword">double</span>[sequence.length-1][];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;537</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[][] y1Diag = <span class="keyword">new</span> <span class="keyword">double</span>[sequence.length-1][];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;538</td>
  <td class="nbHitsCovered">&nbsp;126</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> k = 0; k &lt; sequence.length-1; ++k) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;539</td>
  <td class="nbHitsCovered">&nbsp;112</td>
  <td class="src"><pre class="src">&nbsp;      diagonal[k] = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;540</td>
  <td class="nbHitsCovered">&nbsp;112</td>
  <td class="src"><pre class="src">&nbsp;      y1Diag[k] = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;541</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;542</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;543</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[][][] fk  = <span class="keyword">new</span> <span class="keyword">double</span>[sequence.length][][];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;544</td>
  <td class="nbHitsCovered">&nbsp;140</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">for</span> (<span class="keyword">int</span> k = 0; k &lt; sequence.length; ++k) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;545</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;546</td>
  <td class="nbHitsCovered">&nbsp;126</td>
  <td class="src"><pre class="src">&nbsp;      fk[k]    = <span class="keyword">new</span> <span class="keyword">double</span>[sequence[k] + 1][];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;547</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;548</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// all substeps start at the same point, so share the first array</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;549</td>
  <td class="nbHitsCovered">&nbsp;126</td>
  <td class="src"><pre class="src">&nbsp;      fk[k][0] = yDot0;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;550</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;551</td>
  <td class="nbHitsCovered">&nbsp;2322</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> l = 0; l &lt; sequence[k]; ++l) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;552</td>
  <td class="nbHitsCovered">&nbsp;2196</td>
  <td class="src"><pre class="src">&nbsp;        fk[k][l+1] = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;553</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;554</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;555</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;556</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;557</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (y != y0) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;558</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;      System.arraycopy(y0, 0, y, 0, y0.length);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;559</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;560</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;561</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[] yDot1      = <span class="keyword">null</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;562</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[][] yMidDots = <span class="keyword">null</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;563</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (denseOutput) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;564</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;      yDot1    = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;565</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;      yMidDots = <span class="keyword">new</span> <span class="keyword">double</span>[1 + 2 * sequence.length][];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;566</td>
  <td class="nbHitsCovered">&nbsp;260</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">int</span> j = 0; j &lt; yMidDots.length; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;567</td>
  <td class="nbHitsCovered">&nbsp;247</td>
  <td class="src"><pre class="src">&nbsp;        yMidDots[j] = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;568</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;569</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;570</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;      yMidDots    = <span class="keyword">new</span> <span class="keyword">double</span>[1][];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;571</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;      yMidDots[0] = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;572</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;573</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;574</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// initial scaling</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;575</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>[] scale = <span class="keyword">new</span> <span class="keyword">double</span>[y0.length];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;576</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    rescale(y, y, scale);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;577</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;578</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// initial order selection</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;579</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span> log10R = Math.log(Math.max(1.0e-10,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;580</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      (vecRelativeTolerance == <span class="keyword">null</span>)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;581</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      ? scalRelativeTolerance</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;582</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                      : vecRelativeTolerance[0]))</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;583</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  / Math.log(10.0);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;584</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">int</span> targetIter = Math.max(1,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;585</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                              Math.min(sequence.length - 2,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;586</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                       (<span class="keyword">int</span>) Math.floor(0.5 - 0.6 * log10R)));</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;587</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    <span class="comment">// set up an interpolator sharing the integrator arrays</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;588</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    AbstractStepInterpolator interpolator = <span class="keyword">null</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;589</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">if</span> (denseOutput || (! switchesHandler.isEmpty())) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;590</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;      interpolator = <span class="keyword">new</span> GraggBulirschStoerStepInterpolator(y, yDot0,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;591</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                                            y1, yDot1,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;592</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                                            yMidDots, forward);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;593</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;    } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;594</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;      interpolator = <span class="keyword">new</span> DummyStepInterpolator(y, forward);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;595</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;596</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    interpolator.storeTime(t0);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;597</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;598</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>  currentT         = t0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;599</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>  hNew             = 0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;600</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">double</span>  maxError         = Double.MAX_VALUE;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;601</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">boolean</span> previousRejected = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;602</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">boolean</span> firstTime        = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;603</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">boolean</span> newStep          = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;604</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">boolean</span> lastStep         = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;605</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">boolean</span> firstStepAlreadyComputed = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;606</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    handler.reset();</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;607</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;    costPerTimeUnit[0] = 0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;608</td>
  <td class="nbHitsCovered">&nbsp;365</td>
  <td class="src"><pre class="src">&nbsp;    <span class="keyword">while</span> (! lastStep) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;609</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;610</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">double</span> h;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;611</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">double</span> error;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;612</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">boolean</span> reject = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;613</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;614</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (newStep) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;615</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;616</td>
  <td class="nbHitsCovered">&nbsp;281</td>
  <td class="src"><pre class="src">&nbsp;        interpolator.shift();</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;617</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;618</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// first evaluation, at the beginning of the step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;619</td>
  <td class="nbHitsCovered">&nbsp;281</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (! firstStepAlreadyComputed) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;620</td>
  <td class="nbHitsCovered">&nbsp;82</td>
  <td class="src"><pre class="src">&nbsp;          equations.computeDerivatives(currentT, y, yDot0);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;621</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;622</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;623</td>
  <td class="nbHitsCovered">&nbsp;281</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (firstTime) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;624</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;625</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;          hNew = initializeStep(equations, forward,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;626</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                2 * targetIter + 1, scale,</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;627</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                currentT, y, yDot0, yTmp, yTmpDot);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;628</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;629</td>
  <td class="nbHitsCovered">&nbsp;14</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (! forward) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;630</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;            hNew = -hNew;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;631</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;632</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;633</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;634</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;635</td>
  <td class="nbHitsCovered">&nbsp;281</td>
  <td class="src"><pre class="src">&nbsp;        newStep = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;636</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;637</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;638</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;639</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      h = hNew;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;640</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;641</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// step adjustment near bounds</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;642</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> ((forward &amp;&amp; (currentT + h &gt; t))</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;643</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          || ((! forward) &amp;&amp; (currentT + h &lt; t))) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;644</td>
  <td class="nbHitsCovered">&nbsp;12</td>
  <td class="src"><pre class="src">&nbsp;        h = t - currentT;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;645</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;646</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">double</span> nextT = currentT + h;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;647</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      lastStep = forward ? (nextT &gt;= t) : (nextT &lt;= t);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;648</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;649</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// iterate over several substep sizes</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;650</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">int</span> k = -1;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;651</td>
  <td class="nbHitsCovered">&nbsp;352</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">for</span> (<span class="keyword">boolean</span> loop = <span class="keyword">true</span>; loop; ) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;652</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;653</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;        ++k;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;654</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;655</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// modified midpoint integration with the current substep</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;656</td>
  <td class="nbHitsCovered">&nbsp;1382</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> ( ! tryStep(equations, currentT, y, h, k, scale, fk[k],</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;657</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                       (k == 0) ? yMidDots[0] : diagonal[k-1],</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;658</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                       (k == 0) ? y1 : y1Diag[k-1],</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;659</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                       yTmp)) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;660</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;661</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// the stability check failed, we reduce the global step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;662</td>
  <td class="nbHitsCovered">&nbsp;55</td>
  <td class="src"><pre class="src">&nbsp;          hNew   = Math.abs(filterStep(h * stabilityReduction, <span class="keyword">false</span>));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;663</td>
  <td class="nbHitsCovered">&nbsp;55</td>
  <td class="src"><pre class="src">&nbsp;          reject = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;664</td>
  <td class="nbHitsCovered">&nbsp;55</td>
  <td class="src"><pre class="src">&nbsp;          loop   = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;665</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;666</td>
  <td class="nbHitsCovered">&nbsp;55</td>
  <td class="src"><pre class="src">&nbsp;        } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;667</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;668</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// the substep was computed successfully</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;669</td>
  <td class="nbHitsCovered">&nbsp;1327</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (k &gt; 0) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;670</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;671</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            <span class="comment">// extrapolate the state at the end of the step</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;672</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            <span class="comment">// using last iteration data</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;673</td>
  <td class="nbHitsCovered">&nbsp;1030</td>
  <td class="src"><pre class="src">&nbsp;            extrapolate(0, k, y1Diag, y1);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;674</td>
  <td class="nbHitsCovered">&nbsp;1030</td>
  <td class="src"><pre class="src">&nbsp;            rescale(y, y1, scale);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;675</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;676</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            <span class="comment">// estimate the error at the end of the step.</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;677</td>
  <td class="nbHitsCovered">&nbsp;1030</td>
  <td class="src"><pre class="src">&nbsp;            error = 0;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;678</td>
  <td class="nbHitsCovered">&nbsp;4635</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">for</span> (<span class="keyword">int</span> j = 0; j &lt; y0.length; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;679</td>
  <td class="nbHitsCovered">&nbsp;3605</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">double</span> e = Math.abs(y1[j] - y1Diag[0][j]) / scale[j];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;680</td>
  <td class="nbHitsCovered">&nbsp;3605</td>
  <td class="src"><pre class="src">&nbsp;              error += e * e;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;681</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;682</td>
  <td class="nbHitsCovered">&nbsp;1030</td>
  <td class="src"><pre class="src">&nbsp;            error = Math.sqrt(error / y0.length);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;683</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;684</td>
  <td class="nbHitsCovered">&nbsp;1030</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">if</span> ((error &gt; 1.0e15) || ((k &gt; 1) &amp;&amp; (error &gt; maxError))) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;685</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="comment">// error is too big, we reduce the global step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;686</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;              hNew   = Math.abs(filterStep(h * stabilityReduction, <span class="keyword">false</span>));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;687</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;              reject = <span class="keyword">true</span>;</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;688</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;              loop   = <span class="keyword">false</span>;</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;689</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;            } <span class="keyword">else</span> {</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;690</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;691</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              maxError = Math.max(4 * error, 1.0);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;692</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;693</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="comment">// compute optimal stepsize for this order</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;694</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">double</span> exp = 1.0 / (2 * k + 1);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;695</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">double</span> fac = stepControl2 / Math.pow(error / stepControl1, exp);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;696</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">double</span> pow = Math.pow(stepControl3, exp);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;697</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              fac = Math.max(pow / stepControl4, Math.min(1 / pow, fac));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;698</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              optimalStep[k]     = Math.abs(filterStep(h * fac, <span class="keyword">true</span>));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;699</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              costPerTimeUnit[k] = costPerStep[k] / optimalStep[k];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;700</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;701</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="comment">// check convergence</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;702</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">switch</span> (k - targetIter) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;703</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;704</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">case</span> -1 :</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;705</td>
  <td class="nbHitsCovered">&nbsp;273</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">if</span> ((targetIter &gt; 1) &amp;&amp; ! previousRejected) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;706</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;707</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="comment">// check if we can stop iterations now</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;708</td>
  <td class="nbHitsCovered">&nbsp;211</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="keyword">if</span> (error &lt;= 1.0) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;709</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="comment">// convergence have been reached just before targetIter</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;710</td>
  <td class="nbHitsCovered">&nbsp;123</td>
  <td class="src"><pre class="src">&nbsp;                    loop = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;711</td>
  <td class="nbHitsCovered">&nbsp;123</td>
  <td class="src"><pre class="src">&nbsp;                  } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;712</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="comment">// estimate if there is a chance convergence will</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;713</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="comment">// be reached on next iteration, using the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;714</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="comment">// asymptotic evolution of error</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;715</td>
  <td class="nbHitsCovered">&nbsp;88</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="keyword">double</span> ratio = ((<span class="keyword">double</span>) sequence [k] * sequence[k+1])</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;716</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                 / (sequence[0] * sequence[0]);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;717</td>
  <td class="nbHitsCovered">&nbsp;88</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="keyword">if</span> (error &gt; ratio * ratio) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;718</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                      <span class="comment">// we don't expect to converge on next iteration</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;719</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                      <span class="comment">// we reject the step immediately and reduce order</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;720</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;                      reject = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;721</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;                      loop   = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;722</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;                      targetIter = k;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;723</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;                      <span class="keyword">if</span> ((targetIter &gt; 1)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;724</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                          &amp;&amp; (costPerTimeUnit[targetIter-1]</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;725</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                              &lt; orderControl1 * costPerTimeUnit[targetIter])) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;726</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;                        --targetIter;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;727</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                      }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;728</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;                      hNew = optimalStep[targetIter];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;729</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;730</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;731</td>
  <td class="nbHitsCovered">&nbsp;88</td>
  <td class="src"><pre class="src">&nbsp;                }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;732</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">break</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;733</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;734</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">case</span> 0:</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;735</td>
  <td class="nbHitsCovered">&nbsp;147</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">if</span> (error &lt;= 1.0) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;736</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="comment">// convergence has been reached exactly at targetIter</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;737</td>
  <td class="nbHitsCovered">&nbsp;135</td>
  <td class="src"><pre class="src">&nbsp;                  loop = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;738</td>
  <td class="nbHitsCovered">&nbsp;135</td>
  <td class="src"><pre class="src">&nbsp;                } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;739</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="comment">// estimate if there is a chance convergence will</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;740</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="comment">// be reached on next iteration, using the</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;741</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="comment">// asymptotic evolution of error</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;742</td>
  <td class="nbHitsCovered">&nbsp;12</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="keyword">double</span> ratio = ((<span class="keyword">double</span>) sequence[k+1]) / sequence[0];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;743</td>
  <td class="nbHitsCovered">&nbsp;12</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="keyword">if</span> (error &gt; ratio * ratio) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;744</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="comment">// we don't expect to converge on next iteration</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;745</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="comment">// we reject the step immediately</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;746</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                    reject = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;747</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                    loop = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;748</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                    <span class="keyword">if</span> ((targetIter &gt; 1)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;749</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                        &amp;&amp; (costPerTimeUnit[targetIter-1]</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;750</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                            &lt; orderControl1 * costPerTimeUnit[targetIter])) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;751</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;                      --targetIter;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;752</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                    }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;753</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                    hNew = optimalStep[targetIter];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;754</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;755</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;756</td>
  <td class="nbHitsCovered">&nbsp;12</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">break</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;757</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;758</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">case</span> 1 :</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;759</td>
  <td class="nbHitsCovered">&nbsp;11</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">if</span> (error &gt; 1.0) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;760</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                  reject = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;761</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                  <span class="keyword">if</span> ((targetIter &gt; 1)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;762</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                      &amp;&amp; (costPerTimeUnit[targetIter-1]</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;763</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                          &lt; orderControl1 * costPerTimeUnit[targetIter])) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;764</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;                    --targetIter;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;765</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                  }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;766</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;                  hNew = optimalStep[targetIter];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;767</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;768</td>
  <td class="nbHitsCovered">&nbsp;11</td>
  <td class="src"><pre class="src">&nbsp;                loop = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;769</td>
  <td class="nbHitsCovered">&nbsp;11</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">break</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;770</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;771</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">default</span> :</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;772</td>
  <td class="nbHitsCovered">&nbsp;598</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">if</span> ((firstTime || lastStep) &amp;&amp; (error &lt;= 1.0)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;773</td>
  <td class="nbHitsCovered">&nbsp;20</td>
  <td class="src"><pre class="src">&nbsp;                  loop = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;774</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;775</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                <span class="keyword">break</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;776</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;777</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;778</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;779</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;780</td>
  <td class="nbHitsCovered">&nbsp;1029</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;781</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;782</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;783</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;784</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      <span class="comment">// dense output handling</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;785</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">double</span> hInt = getMaxStep();</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;786</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (denseOutput &amp;&amp; ! reject) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;787</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;788</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// extrapolate state at middle point of the step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;789</td>
  <td class="nbHitsCovered">&nbsp;951</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">for</span> (<span class="keyword">int</span> j = 1; j &lt;= k; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;790</td>
  <td class="nbHitsCovered">&nbsp;727</td>
  <td class="src"><pre class="src">&nbsp;          extrapolate(0, j, diagonal, yMidDots[0]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;791</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;792</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;793</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// derivative at end of step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;794</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;        equations.computeDerivatives(currentT + h, y1, yDot1);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;795</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;796</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">int</span> mu = 2 * k - mudif + 3;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;797</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;798</td>
  <td class="nbHitsCovered">&nbsp;1454</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">for</span> (<span class="keyword">int</span> l = 0; l &lt; mu; ++l) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;799</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;800</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// derivative at middle point of the step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;801</td>
  <td class="nbHitsCovered">&nbsp;1230</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">int</span> l2 = l / 2;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;802</td>
  <td class="nbHitsCovered">&nbsp;1230</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">double</span> factor = Math.pow(0.5 * sequence[l2], l);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;803</td>
  <td class="nbHitsCovered">&nbsp;1230</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">int</span> middleIndex = fk[l2].length / 2;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;804</td>
  <td class="nbHitsCovered">&nbsp;5262</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;805</td>
  <td class="nbHitsCovered">&nbsp;4032</td>
  <td class="src"><pre class="src">&nbsp;            yMidDots[l+1][i] = factor * fk[l2][middleIndex + l][i];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;806</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;807</td>
  <td class="nbHitsCovered">&nbsp;4370</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">for</span> (<span class="keyword">int</span> j = 1; j &lt;= k - l2; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;808</td>
  <td class="nbHitsCovered">&nbsp;3140</td>
  <td class="src"><pre class="src">&nbsp;            factor = Math.pow(0.5 * sequence[j + l2], l);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;809</td>
  <td class="nbHitsCovered">&nbsp;3140</td>
  <td class="src"><pre class="src">&nbsp;            middleIndex = fk[l2+j].length / 2;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;810</td>
  <td class="nbHitsCovered">&nbsp;13086</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;811</td>
  <td class="nbHitsCovered">&nbsp;9946</td>
  <td class="src"><pre class="src">&nbsp;              diagonal[j-1][i] = factor * fk[l2+j][middleIndex+l][i];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;812</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;813</td>
  <td class="nbHitsCovered">&nbsp;3140</td>
  <td class="src"><pre class="src">&nbsp;            extrapolate(l2, j, diagonal, yMidDots[l+1]);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;814</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;815</td>
  <td class="nbHitsCovered">&nbsp;5262</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;816</td>
  <td class="nbHitsCovered">&nbsp;4032</td>
  <td class="src"><pre class="src">&nbsp;            yMidDots[l+1][i] *= h;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;817</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;818</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;819</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// compute centered differences to evaluate next derivatives</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;820</td>
  <td class="nbHitsCovered">&nbsp;5097</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">for</span> (<span class="keyword">int</span> j = (l + 1) / 2; j &lt;= k; ++j) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;821</td>
  <td class="nbHitsCovered">&nbsp;30402</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">for</span> (<span class="keyword">int</span> m = fk[j].length - 1; m &gt;= 2 * (l + 1); --m) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;822</td>
  <td class="nbHitsCovered">&nbsp;108056</td>
  <td class="src"><pre class="src">&nbsp;              <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; y0.length; ++i) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;823</td>
  <td class="nbHitsCovered">&nbsp;81521</td>
  <td class="src"><pre class="src">&nbsp;                fk[j][m][i] -= fk[j][m-2][i];</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;824</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;825</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;826</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;827</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;828</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;829</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;830</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (mu &gt;= 0) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;831</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;832</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// estimate the dense output coefficients</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;833</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;          GraggBulirschStoerStepInterpolator gbsInterpolator</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;834</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            = (GraggBulirschStoerStepInterpolator) interpolator;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;835</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;          gbsInterpolator.computeCoefficients(mu, h);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;836</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;837</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (useInterpolationError) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;838</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            <span class="comment">// use the interpolation error to limit stepsize</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;839</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">double</span> interpError = gbsInterpolator.estimateError(scale);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;840</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;            hInt = Math.abs(h / Math.max(Math.pow(interpError, 1.0 / (mu+4)),</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;841</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                         0.01));</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;842</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">if</span> (interpError &gt; 10.0) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;843</td>
  <td class="nbHitsCovered">&nbsp;2</td>
  <td class="src"><pre class="src">&nbsp;              hNew = hInt;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;844</td>
  <td class="nbHitsCovered">&nbsp;2</td>
  <td class="src"><pre class="src">&nbsp;              reject = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;845</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;846</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;847</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;848</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// Switching functions handling</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;849</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (!reject) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;850</td>
  <td class="nbHitsCovered">&nbsp;222</td>
  <td class="src"><pre class="src">&nbsp;            interpolator.storeTime(currentT + h);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;851</td>
  <td class="nbHitsCovered">&nbsp;222</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">if</span> (switchesHandler.evaluateStep(interpolator)) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;852</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;              reject = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;853</td>
  <td class="nbHitsCovered">&nbsp;6</td>
  <td class="src"><pre class="src">&nbsp;              hNew = Math.abs(switchesHandler.getEventTime() - currentT);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;854</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;855</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;856</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;857</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;858</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;859</td>
  <td class="nbHitsCovered">&nbsp;224</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (!reject) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;860</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// we will reuse the slope for the beginning of next step</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;861</td>
  <td class="nbHitsCovered">&nbsp;216</td>
  <td class="src"><pre class="src">&nbsp;          firstStepAlreadyComputed = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;862</td>
  <td class="nbHitsCovered">&nbsp;216</td>
  <td class="src"><pre class="src">&nbsp;          System.arraycopy(yDot1, 0, yDot0, 0, y0.length);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;863</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;864</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;865</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;866</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;867</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (! reject) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;868</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;869</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// store end of step state</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;870</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        currentT += h;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;871</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        System.arraycopy(y1, 0, y, 0, y0.length);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;872</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;873</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        switchesHandler.stepAccepted(currentT, y);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;874</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (switchesHandler.stop()) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;875</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;          lastStep = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;876</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;877</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;878</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="comment">// provide the step data to the step handler</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;879</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        interpolator.storeTime(currentT);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;880</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        handler.handleStep(interpolator, lastStep);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;881</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;882</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (switchesHandler.reset(currentT, y) &amp;&amp; ! lastStep) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;883</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// some switching function has triggered changes that</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;884</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// invalidate the derivatives, we need to recompute them</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;885</td>
  <td class="nbHitsCovered">&nbsp;5</td>
  <td class="src"><pre class="src">&nbsp;          firstStepAlreadyComputed = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;886</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;887</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;888</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">int</span> optimalIter;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;889</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (k == 1) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;890</td>
  <td class="nbHitsCovered">&nbsp;8</td>
  <td class="src"><pre class="src">&nbsp;          optimalIter = 2;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;891</td>
  <td class="nbHitsCovered">&nbsp;8</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (previousRejected) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;892</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;            optimalIter = 1;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;893</td>
  <td class="nbHitsCovered">&nbsp;1</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;894</td>
  <td class="nbHitsCovered">&nbsp;272</td>
  <td class="src"><pre class="src">&nbsp;        } <span class="keyword">else</span> <span class="keyword">if</span> (k &lt;= targetIter) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;895</td>
  <td class="nbHitsCovered">&nbsp;264</td>
  <td class="src"><pre class="src">&nbsp;          optimalIter = k;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;896</td>
  <td class="nbHitsCovered">&nbsp;264</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (costPerTimeUnit[k-1] &lt; orderControl1 * costPerTimeUnit[k]) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;897</td>
  <td class="nbHitsCovered">&nbsp;30</td>
  <td class="src"><pre class="src">&nbsp;            optimalIter = k-1;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;898</td>
  <td class="nbHitsCovered">&nbsp;30</td>
  <td class="src"><pre class="src">&nbsp;          } <span class="keyword">else</span> <span class="keyword">if</span> (costPerTimeUnit[k] &lt; orderControl2 * costPerTimeUnit[k-1]) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;899</td>
  <td class="nbHitsCovered">&nbsp;198</td>
  <td class="src"><pre class="src">&nbsp;            optimalIter = Math.min(k+1, sequence.length - 2);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;900</td>
  <td class="nbHitsCovered">&nbsp;198</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;901</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;902</td>
  <td class="nbHitsCovered">&nbsp;8</td>
  <td class="src"><pre class="src">&nbsp;          optimalIter = k - 1;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;903</td>
  <td class="nbHitsCovered">&nbsp;8</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> ((k &gt; 2)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;904</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;              &amp;&amp; (costPerTimeUnit[k-2] &lt; orderControl1 * costPerTimeUnit[k-1])) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;905</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;            optimalIter = k - 2;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;906</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;907</td>
  <td class="nbHitsCovered">&nbsp;8</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (costPerTimeUnit[k] &lt; orderControl2 * costPerTimeUnit[optimalIter]) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;908</td>
  <td class="nbHitsCovered">&nbsp;5</td>
  <td class="src"><pre class="src">&nbsp;            optimalIter = Math.min(k, sequence.length - 2);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;909</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;910</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;911</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;912</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        <span class="keyword">if</span> (previousRejected) {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;913</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// after a rejected step neither order nor stepsize</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;914</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// should increase</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;915</td>
  <td class="nbHitsCovered">&nbsp;62</td>
  <td class="src"><pre class="src">&nbsp;          targetIter = Math.min(optimalIter, k);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;916</td>
  <td class="nbHitsCovered">&nbsp;62</td>
  <td class="src"><pre class="src">&nbsp;          hNew = Math.min(Math.abs(h), optimalStep[targetIter]);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;917</td>
  <td class="nbHitsCovered">&nbsp;62</td>
  <td class="src"><pre class="src">&nbsp;        } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;918</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          <span class="comment">// stepsize control</span></pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;919</td>
  <td class="nbHitsCovered">&nbsp;218</td>
  <td class="src"><pre class="src">&nbsp;          <span class="keyword">if</span> (optimalIter &lt;= k) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;920</td>
  <td class="nbHitsCovered">&nbsp;25</td>
  <td class="src"><pre class="src">&nbsp;            hNew = optimalStep[optimalIter];</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;921</td>
  <td class="nbHitsCovered">&nbsp;25</td>
  <td class="src"><pre class="src">&nbsp;          } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;922</td>
  <td class="nbHitsCovered">&nbsp;193</td>
  <td class="src"><pre class="src">&nbsp;            <span class="keyword">if</span> ((k &lt; targetIter)</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;923</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                &amp;&amp; (costPerTimeUnit[k] &lt; orderControl2 * costPerTimeUnit[k-1])) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;924</td>
  <td class="nbHitsCovered">&nbsp;128</td>
  <td class="src"><pre class="src">&nbsp;              hNew = filterStep(optimalStep[k]</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;925</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                * costPerStep[optimalIter+1] / costPerStep[k],</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;926</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                <span class="keyword">false</span>);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;927</td>
  <td class="nbHitsCovered">&nbsp;128</td>
  <td class="src"><pre class="src">&nbsp;            } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;928</td>
  <td class="nbHitsCovered">&nbsp;65</td>
  <td class="src"><pre class="src">&nbsp;              hNew = filterStep(optimalStep[k]</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;929</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                * costPerStep[optimalIter] / costPerStep[k],</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;930</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;                                <span class="keyword">false</span>);</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;931</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;            }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;932</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;          }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;933</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;934</td>
  <td class="nbHitsCovered">&nbsp;218</td>
  <td class="src"><pre class="src">&nbsp;          targetIter = optimalIter;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;935</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;936</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;        }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;937</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;938</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        newStep = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;939</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;940</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;941</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;942</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      hNew = Math.min(hNew, hInt);</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;943</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (! forward) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;944</td>
  <td class="nbHitsUncovered">&nbsp;0</td>
  <td class="src"><pre class="src"><span class="srcUncovered">&nbsp;        hNew = -hNew;</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;945</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;946</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;947</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      firstTime = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;948</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;949</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;      <span class="keyword">if</span> (reject) {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;950</td>
  <td class="nbHitsCovered">&nbsp;71</td>
  <td class="src"><pre class="src">&nbsp;        lastStep = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;951</td>
  <td class="nbHitsCovered">&nbsp;71</td>
  <td class="src"><pre class="src">&nbsp;        previousRejected = <span class="keyword">true</span>;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;952</td>
  <td class="nbHitsCovered">&nbsp;71</td>
  <td class="src"><pre class="src">&nbsp;      } <span class="keyword">else</span> {</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;953</td>
  <td class="nbHitsCovered">&nbsp;280</td>
  <td class="src"><pre class="src">&nbsp;        previousRejected = <span class="keyword">false</span>;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;954</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;      }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;955</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;956</td>
  <td class="nbHitsCovered">&nbsp;351</td>
  <td class="src"><pre class="src">&nbsp;    }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;957</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLineCover">&nbsp;958</td>
  <td class="nbHitsCovered">&nbsp;13</td>
  <td class="src"><pre class="src">&nbsp;  }</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;959</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;960</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** maximal order. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;961</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">int</span> maxOrder;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;962</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;963</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** step size sequence. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;964</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">int</span>[] sequence;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;965</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;966</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** overall cost of applying step reduction up to iteration k+1,</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;967</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   *  in number of calls.</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;968</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;<span class="comment">   */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;969</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">int</span>[] costPerStep;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;970</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;971</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** cost per unit step. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;972</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span>[] costPerTimeUnit;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;973</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;974</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** optimal steps for each order. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;975</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span>[] optimalStep;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;976</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;977</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** extrapolation coefficients. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;978</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span>[][] coeff;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;979</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;980</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** stability check enabling parameter. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;981</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">boolean</span> performTest;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;982</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;983</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** maximal number of checks for each iteration. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;984</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">int</span> maxChecks;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;985</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;986</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** maximal number of iterations for which checks are performed. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;987</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">int</span> maxIter;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;988</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;989</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** stepsize reduction factor in case of stability check failure. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;990</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> stabilityReduction;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;991</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;992</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** first stepsize control factor. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;993</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> stepControl1;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;994</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;995</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** second stepsize control factor. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;996</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> stepControl2;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;997</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;998</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** third stepsize control factor. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;999</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> stepControl3;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1000</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1001</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** fourth stepsize control factor. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1002</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> stepControl4;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1003</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1004</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** first order control factor. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1005</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> orderControl1;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1006</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1007</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** second order control factor. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1008</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">double</span> orderControl2;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1009</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1010</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** dense outpute required. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1011</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">boolean</span> denseOutput;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1012</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1013</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** use interpolation error in stepsize control. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1014</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">boolean</span> useInterpolationError;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1015</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1016</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="comment">/** interpolation order control parameter. */</span></pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1017</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;  <span class="keyword">private</span> <span class="keyword">int</span> mudif;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1018</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;</pre></td>
</tr>
<tr>
  <td class="numLine">&nbsp;1019</td>
  <td class="nbHits">&nbsp;</td>
  <td class="src"><pre class="src">&nbsp;}</pre></td>
</tr>
</table>
</p>
<div class="footer">
Reports generated by <a href="http://cobertura.sourceforge.net/" target="_top">Cobertura</a>.
</div>
</body>
</html>
